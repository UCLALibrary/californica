language: ruby
sudo: false
cache:
  bundler: true
  directories:
    - tmp/solr_downloads
    - tmp/fedora_downloads
dist: trusty
jdk:
- oraclejdk8
rvm:
- 2.5
env:
  global:
    - DATABASE_USERNAME=travis
    - secure: "eTxFESeEn4I3u5sHFtg4/EFsOlryXVRv21Va7OZbZGbCY/mbDtaKDkW7IRkMkARKDxIo9RNnFNvKULCQZTkF24LWa3Ohjbse3UdEPv2FsW9sRZSLBAOaKUiKX6l7xbiaMRD5iwcZ+PMXaRxGhFhKFp+Rl3s4+R/8gJNJn8G75j+q7dzqTS8dPdAseidv8Dm2SJVTXgYp4v965RJMG3tKw3VW1IASWO342+HIfQYPL4qaUFMhDbrAol0hXLk8wH6FN0HQsb8OvxRr+xb6yOa5NKnWDmGVQ/P0vUQRy6jmTIUd+X/tFBQv4NfrkHjcyphGdIwrEgGG7rpWNQDVCXXQCIYTO0eAkC3lR+PFAB3iwJHdoeOm6kS8HQW87e27HdQl4asPyj4z4t+SMPW/jO+u/fRKQCDISABwudLFL+ad2pNTffoCs2hsRf64NMVcAoY/vVjden5Rzon2Ww6xGkPzez0T89ANsdOsqrVrg1hvaxkM8n3gFpazOAhPY1gziX2LR7rMSZT04FzQLQVnxVafqsZDpWB4Gbv2yeokf7xnqUY86WqiIzpQRfIRPxkIdWemO7WWSPTsinAZg7TLQKRDtjKMKbsb4UNxM4vD4GPTzBpt95+mTlF2L8jrq9EuwNpFrw4CXgLpAEA3/DBl/VdpeVyxa/3gBOo6jISmMgd8riY="
    - secure: "FXAn1jG4FAQ4VkAOtJVJpNcDriAaBXQTpoRXWfWi+BDk4m66KdyGDbF0Z7UsnN4YJ8sT+iqYbhUNHQpKLCBf2cpIVFFelh2+GjRuviVh2Rj6ycjhm1BRG7qfTt2kEq3eOJBqmvXSNl8RPrpLT3J/bPpcO4mhbqW9C4/2/VnqN1Bjf0VVp3CfH3oxtX/rg9sP1160K3r7rACGyabI5Xwo8LqJmVxa12oi19u5Po2YEHTdbdEJ6fSvJ8UlHdtohG9unv+85KNMHhxYNGCNzIdQgaYFEpBVtlBbkIG+H5k75y+SIFziU4BsiUq4liqGg6Om0S/LT+FIfYDl5FWX8py3uGY9FgQq8BMeLtSWgryOLz7xj+y07ht3Ks8DoWE5laxpvseXqFjqdT2PyUpT2HCcE5dNV4oJszycykA+zTgjPFebn2634lzN1gsLfzzsY91lsCTB3jj5k2FrBf3/q7c/YoSvekdbZc3qi78yb/AX7iG5B1HOhTesKuV3duuxYwWByVlValXLu8YA47Nsgoo7oVOGgzg2fGjRZlRCwYz2EC+OXyM3mnk/sMBeaGybDJfEg4wygB3tWIosff0Al2T7dO+1XeBysynXE19OLH75v9vX3/Zn4RySj8UB1DzzDDle7PYSJbgL+Er4VdgY3FsXBl2VfQ36rXuPO13u1FxamVo="
before_script:
- bundle exec rake db:create
script:
- bundle exec rake
services:
- redis-server
- mysql
after_success:
- |
  if [[ $TRAVIS_BRANCH == 'master' && $TRAVIS_PULL_REQUEST == 'false' ]]; then
    curl "$JENKINS_DEPLOY_URL"
  fi
  if [[ $TRAVIS_TAG =~ ^sprint[0-9]*\.rc[0-9]* ]]; then
    curl "$JENKINS_TAG_DEPLOY_URL"
  fi
